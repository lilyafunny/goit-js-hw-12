{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `\n        <li class = \"list-foto\">\n        <div class=\"container\">\n        <a class=\"foto-link\" href=\"${largeImageURL}\">\n            <img width=\"360px\" height=\"200px\" class=\"foto\" src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        <div class=\"text-overlay\">\n        <div class=\"overlay-list likes\"> \n            <h3 class=\"likes-text\">Likes</h3>\n            <p class=\"likes-text\">${likes}</p>\n        </div>\n        <div class=\"overlay-list views\"> \n            <h3 class=\"views-text\">Views</h3>\n            <p class=\"views-text\">${views}</p>\n        </div>\n        <div class=\"overlay-list comments\"> \n            <h3 class=\"comments-text\">Comments</h3>\n            <p class=\"comments-text\">${comments}</p>\n        </div>\n        <div class=\"overlay-list downloads\"> \n            <h3 class=\"downloads-text\">Downloads</h3>\n            <p class=\"downloads-text\">${downloads}</p>\n        </div>\n        </div>    \n        </div>\n        </li>\n\n    `\n    ).join(\"\");\n}","import axios from \"axios\";\n\n\nconst API_KEY = \"47015926-a75abbcadb56cf8cc5bf9ef48\";\n\n\nexport async function fetchData(foto = \"\", page = 1) {\n\n    const result = await axios.get(\"https://pixabay.com/api/\", {\n        params: {\n\n            key: API_KEY,\n            q: foto,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: \"true\",\n            page,\n            per_page: 15\n\n        }\n    });\n\n    return result.data;\n\n}","\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { createMarkup } from './js/render-functions.js'\nimport { fetchData } from './js/pixabay-api.js'\n\nconst formEl = document.querySelector(\".js-search-form\");\nconst listEl = document.querySelector(\".gallery\");\nconst loadingEl = document.querySelector(\".loader\");\n\nconst loadMore = document.querySelector(\".js-load-more\");\n\nformEl.addEventListener(\"submit\", handlSearch);\nloadMore.addEventListener(\"click\", onLoadMore);\n\nlet lightbox = new SimpleLightbox('.gallery a');\nlet page = 1;\nlet globalCurrent = \"\";\nlet totalPage = 0;\n\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nasync function handlSearch(event) {\n    event.preventDefault();\n    page = 1;\n    const { foto } = event.currentTarget.elements;\n    globalCurrent = foto.value.trim();\n\n\n    if (!globalCurrent) {\n        iziToast.error({\n            message: 'Please enter text to search.',\n            position: 'topRight'\n        });\n        return;\n    }\n\n    listEl.innerHTML = '';\n\n    loadMore.classList.replace(\"load-more\", \"load-more-hidden\");\n\n    showLoading();\n    await sleep(1000);\n\n    try {\n\n        const data = await fetchData(globalCurrent, page);\n        totalPage = data.totalHits / 15;\n\n        if (data.hits.length == 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight'\n            });\n            return;\n        }\n\n        listEl.innerHTML = createMarkup(data.hits);\n        lightbox.refresh();\n\n        if (page < totalPage) {\n            loadMore.classList.replace(\"load-more-hidden\", \"load-more\");\n        }\n\n    } catch (error) {\n        console.log(\"error\", error);\n    } finally {\n        hideLoading();\n        formEl.reset();\n    }\n\n\n}\n\n\nasync function onLoadMore() {\n\n    page += 1;\n\n    loadMore.disabled = true;\n    loadMore.classList.replace(\"load-more\", \"load-more-hidden\");\n    showLoading();\n    await sleep(1000);\n\n    try {\n\n        const data = await fetchData(globalCurrent, page);\n        listEl.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n        lightbox.refresh();\n\n\n        if (page >= totalPage) {\n            loadMore.style.display = \"none\";\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight'\n            });\n        } else {\n            loadMore.classList.replace(\"load-more-hidden\", \"load-more\");\n        }\n\n        const card = document.querySelector(\".container\");\n        const cardHeight = card.getBoundingClientRect().height;\n\n        window.scrollBy({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        })\n\n    } catch (error) {\n\n        console.log(\"error\", error);\n\n    } finally {\n        loadMore.disabled = false;\n        hideLoading();\n    }\n\n}\n\nfunction showLoading() {\n    loadingEl.style.display = 'block';\n}\n\nfunction hideLoading() {\n    loadingEl.style.display = 'none';\n}"],"names":["createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","API_KEY","fetchData","foto","page","axios","formEl","listEl","loadingEl","loadMore","handlSearch","onLoadMore","lightbox","SimpleLightbox","globalCurrent","totalPage","sleep","ms","resolve","event","iziToast","showLoading","data","error","hideLoading","cardHeight"],"mappings":"+vBAAO,SAASA,EAAaC,EAAK,CAC9B,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACpF;AAAA;AAAA;AAAA,qCAG6BL,CAAa;AAAA,kEACgBD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,oCAKxDC,CAAK;AAAA;AAAA;AAAA;AAAA,oCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,uCAIFC,CAAQ;AAAA;AAAA;AAAA;AAAA,wCAIPC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOjD,EAAM,KAAK,EAAE,CACb,CC5BA,MAAMC,EAAU,qCAGT,eAAeC,EAAUC,EAAO,GAAIC,EAAO,EAAG,CAgBjD,OAde,MAAMC,EAAM,IAAI,2BAA4B,CACvD,OAAQ,CAEJ,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAAC,EACA,SAAU,EAEb,CACT,CAAK,GAEa,IAElB,CCdA,MAAME,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAS,SAAS,cAAc,UAAU,EAC1CC,EAAY,SAAS,cAAc,SAAS,EAE5CC,EAAW,SAAS,cAAc,eAAe,EAEvDH,EAAO,iBAAiB,SAAUI,CAAW,EAC7CD,EAAS,iBAAiB,QAASE,CAAU,EAE7C,IAAIC,EAAW,IAAIC,EAAe,YAAY,EAC1CT,EAAO,EACPU,EAAgB,GAChBC,EAAY,EAGhB,SAASC,EAAMC,EAAI,CACf,OAAO,IAAI,QAAQC,GAAW,WAAWA,EAASD,CAAE,CAAC,CACzD,CAEA,eAAeP,EAAYS,EAAO,CAC9BA,EAAM,eAAc,EACpBf,EAAO,EACP,KAAM,CAAE,KAAAD,CAAM,EAAGgB,EAAM,cAAc,SAIrC,GAHAL,EAAgBX,EAAK,MAAM,OAGvB,CAACW,EAAe,CAChBM,EAAS,MAAM,CACX,QAAS,+BACT,SAAU,UACtB,CAAS,EACD,MACH,CAEDb,EAAO,UAAY,GAEnBE,EAAS,UAAU,QAAQ,YAAa,kBAAkB,EAE1DY,IACA,MAAML,EAAM,GAAI,EAEhB,GAAI,CAEA,MAAMM,EAAO,MAAMpB,EAAUY,EAAeV,CAAI,EAGhD,GAFAW,EAAYO,EAAK,UAAY,GAEzBA,EAAK,KAAK,QAAU,EAAG,CACvBF,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAa,EACD,MACH,CAEDb,EAAO,UAAYf,EAAa8B,EAAK,IAAI,EACzCV,EAAS,QAAO,EAEZR,EAAOW,GACPN,EAAS,UAAU,QAAQ,mBAAoB,WAAW,CAGjE,OAAQc,EAAO,CACZ,QAAQ,IAAI,QAASA,CAAK,CAClC,QAAc,CACNC,IACAlB,EAAO,MAAK,CACf,CAGL,CAGA,eAAeK,GAAa,CAExBP,GAAQ,EAERK,EAAS,SAAW,GACpBA,EAAS,UAAU,QAAQ,YAAa,kBAAkB,EAC1DY,IACA,MAAML,EAAM,GAAI,EAEhB,GAAI,CAEA,MAAMM,EAAO,MAAMpB,EAAUY,EAAeV,CAAI,EAChDG,EAAO,mBAAmB,YAAaf,EAAa8B,EAAK,IAAI,CAAC,EAC9DV,EAAS,QAAO,EAGZR,GAAQW,GACRN,EAAS,MAAM,QAAU,OACzBW,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,UAC1B,CAAa,GAEDX,EAAS,UAAU,QAAQ,mBAAoB,WAAW,EAI9D,MAAMgB,EADO,SAAS,cAAc,YAAY,EACxB,sBAAqB,EAAG,OAEhD,OAAO,SAAS,CACZ,KAAM,EACN,IAAKA,EAAa,EAClB,SAAU,QACtB,CAAS,CAEJ,OAAQF,EAAO,CAEZ,QAAQ,IAAI,QAASA,CAAK,CAElC,QAAc,CACNd,EAAS,SAAW,GACpBe,GACH,CAEL,CAEA,SAASH,GAAc,CACnBb,EAAU,MAAM,QAAU,OAC9B,CAEA,SAASgB,GAAc,CACnBhB,EAAU,MAAM,QAAU,MAC9B"}